<!DOCTYPE HTML>
<html>
	<head>
		<title>GodotSteam - A Steamworks Module For Godot Engine | By Gramps | GitHub</title>
		<meta charset="utf-8" />
		<meta http-equiv="X-UA-Compatible" content="chrome=1">
		<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
		<link rel="stylesheet" href="css/main.css?v=2.7" />
		<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.15.4/css/all.css" integrity="sha384-DyZ88mC6Up2uqS4h/KRgHuoeGwBcD4Ng9SiP4dIRy0EXTlnuz47vAwmeGwVChigm" crossorigin="anonymous" />
		<link rel="icon" type="image/x-icon" href="godotsteam-icon.ico">
		<!--[if lt IE 9]>
			<script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
		<![endif]-->
		<!--[if lt IE 8]>
		<link rel="stylesheet" href="{{ '/css/ie.css' | relative_url }}">
		<![endif]-->
	</head>
	<body class="is-preload">
		<!-- Wrapper -->
		<div id="wrapper">
			<!-- Main -->
			<div id="main">
				<div class="inner">
					<!-- Header -->
					<header id="header">
						<a href="index.html" class="logo"><strong>GodotSteam</strong> A Steamworks module for Godot Engine</a>
					</header>
					<section>
	<header class="main">
		<h1>Tutorials - Stats And Achievements</h1>
	</header>
	<p>At some point you may want to save statistics to Steam's database and/or use their achievement system.  You will want to <a href="https://partner.steamgames.com/doc/features/achievements" target="_blank">read up about these in Steam's documentation</a> as I won't be covering the basics on how to set it up in the Steamworks back-end.</p>
	<hr/>
	<header class="major">
		<h3>Preparations</h3>
	</header>
	<p>First thing, you'll want to set up your achievements and statistics in the Steamworks back-end.  Most importantly, you want to publish these changes live.  If not, they will not be exposed to the Steamworks API and you will get errors when trying to retrieve or set them.  Once they have been published you can continue on with this tutorial.</p>
	<header class="major">
		<h3>Getting Steam Statistics And Achievements</h3>
	</header>
	<p>When starting up your game, in most cases, you'll want to pull all related achievements and statistics from Steam's servers for the local user.  There are a few ways to handle connecting the callback for statistics / achievements data received from Steam's servers.</p>
	<p>Unless you choose to turn it off by passing <strong><em>false</em></strong> to the <strong>steamInit()</strong> function; it will automatically request the local user's current statistics and achievements.  I generally pass false to prevent this.</p>

	<p>To retrieve the data from the resulting callback, you need to connect the <strong><em>current_stats_received</em></strong> callback to a function like so:</p>
<pre><code>
Steam.connect("current_stats_received", self, "_steam_Stats_Ready", [], CONNECT_ONESHOT)
</code></pre>
	<p>You'll notice that <strong>CONNECT_ONESHOT</strong> is passed along to prevent this from firing more than once.  This is because that signal is sent any time stats are updated or received and will run the <strong>_steam_Stats_Ready</strong> again.  In my use-cases this is not desirable, but it may be in yours. If you don't mind the <strong>_steam_Stats_Ready</strong> firing each time, depending on your function's logic, feel free to omit that part like so:</p>
<pre><code>
Steam.connect("current_stats_received", self, "_steam_Stats_Ready")
</code></pre>
	<p>If you do keep the <strong>CONNECT_ONESHOT</strong> as I do, I suggest calling for Steam stat updates with <strong>requestUserStats</strong> and pass with it the user's Steam ID.  This function will work with any user: local or remote. You'll also want to connect it's signal in a similar manner:</p>
<pre><code>
Steam.connect("user_stats_received", self, "_steam_Stats_Ready")
</code></pre>
	<p>It can be connected to the same function as <strong>requestCurrentStats</strong> as they send the same data back.  For our example, here is the <strong><em>_steam_Stats_Ready</em></strong> function we listed in the connected signals:</p>
<pre><code>
func _steam_Stats_Ready(game: int, result: int, user: int) -> void:
	print("This game's ID: "+str(game))
	print("Call result: "+str(result))
	print("This user's Steam ID: "+str(user))
</code></pre>
	<hr />
	<header class="major">
		<h3>Working With The Data</h3>
	</header>
	<p>In this function you can check if the result is what you expect (ideally it is 1), see if the given stats are for the current player, and check that the game's ID matches.  Also you can now pass the achievements and stats to local variables or functions. I will often pass the achievement to a function to parse them correctly as they send back a BOOL for retrieval and a BOOL for earned or not.</p>
<pre><code>
var ACHIEVEMENTS: Dictionary = {"achieve1":false, "achieve2":false, "achieve3":false}

func _steam_Stats_Ready(game: int, result: int, user: int) -> void:
	print("This game's ID: "+str(game))
	print("Call result: "+str(result))
	print("This user's Steam ID: "+str(user))

	# Get achievements and pass them to variables
	_get_Achievement("acheive1")
	_get_Achievement("acheive2")
	_get_Achievement("acheive3")

	# Get statistics (int) and pass them to variables
	var HIGHSCORE: int = Steam.getStatInt("HighScore")
	var HEALTH: int = Steam.getStatInt("Health")
	var MONEY: int = Steam.getStatInt("Money")

# Process achievements
func _get_Achievement(value: String) -> void:
	var ACHIEVEMENT: Dictionary = Steam.getAchievement(value)
	# Achievement exists
	if ACHIEVEMENT['ret']:
		# Achievement is unlocked
		if ACHIEVEMENT['achieved']:
			ACHIEVEMENTS[value] = true
		# Achievement is locked
		else:
			ACHIEVEMENTS[value] = false
	# Achievement does not exist
	else:
		ACHIEVEMENTS[value] = false
</code></pre>
	<hr />
	<header class="major">
		<h3>Setting Achievements</h3>
	</header>
	<p>Setting the achievements and statistics is pretty simple too. We'll start with achievements. You need to tell Steam the achievement is unlocked and then store it so 'pops':</p>
<pre><code>
Steam.setAchievement("achieve1")
Steam.storeStats()
</code></pre>
	<p>If you don't call <strong>Steam.storeStats()</strong> the achievement pop-up won't trigger but the achievement should be recorded. However, you will still have to call <strong>Steam.storeStats()</strong> at some point to upload them.  I generally make a generic function to house this process then call it when needed:</p>
<pre><code>
func _fire_Steam_Achievement(value: String) -> void:
	# Set the achievement to an in-game variable
	player.ACHIEVEMENTS[value] = true

	# Pass the value to Steam then fire it
	Steam.setAchievement(value)
	Steam.storeStats()
</code></pre>
	When that last <strong>Steam.storeStats()</strong> is called the achievement will "pop" visually for the user and update their Steam client.</p>
	<hr />
	<header class="major">
		<h3>Setting Statistics</h3>
	</header>
	<p>Statistics follow a pretty similar process; both int and float based ones.  Set them like so:</p>
<pre><code>
Steam.setStatInt("stat1", value)
Steam.setStatFloat("stat2", value)
Steam.storeStats()
</code></pre>
	<p>When that last <strong>Steam.storeStats()</strong> is called the stats will update on Steam's servers.</p>
	<hr/>
	<p>That covers the basics of statistics and achievements.</p>
	<p><a href="https://github.com/Gramps/GodotSteam/tree/example" target="_blank">To see this tutorial in action, check out the example branch on the GodotSteam Github repo.</a> There you can get a full view of the code used which can serve as a starting point for you to branch out from.</p>
</section>					<a href="#" id="to-top" class="display:none;"><i class="fas fa-arrow-alt-circle-up"></i></a>
				</div>
			</div>
			<!-- Sidebar -->
			<div id="sidebar">
	<div id="sidebar-inner" class="inner">
		<!-- Menu -->
		<nav id="menu">
			<header class="major">
				<h2>Menu</h2>
			</header>
			<ul>
				<li><a href="index.html">Introduction</a></li>
				<li>
					<span class="opener">How-To's</span>
					<ul>
						<li><a href="howto-module.html">How-To Godot 2, 3, 4</a></li>
						<li><a href="howto-gdnative.html">How-To GDNative</a></li>
					</ul>
				</li>
				<li>
					<span class="opener">Functions</span>
					<ul>
						<li><a href="functions-main.html">Main</a></li>
						<li><a href="functions-apps.html">Apps</a></li>
						<li><a href="functions-apps-list.html">App Lists</a></li>
						<li><a href="functions-friends.html">Friends</a></li>
						<li><a href="functions-game-search.html">Game Search</a></li>
						<li><a href="functions-game-server.html">Game Server</a></li>
						<li><a href="functions-game-server-stats.html">Game Server Stats</a></li>
						<li><a href="functions-html-surface.html">HTML Surface</a></li>
						<li><a href="functions-http.html">HTTP</a></li>
						<li><a href="functions-input.html">Input</a></li>
						<li><a href="functions-inventory.html">Inventory</a></li>
						<li><a href="functions-matchmaking.html">Matchmaking</a></li>
						<li><a href="functions-matchmaking-servers.html">Matchmaking Servers</a></li>
						<li><a href="functions-music.html">Music</a></li>
						<li><a href="functions-music-remote.html">Music Remote</a></li>
						<li><a href="functions-networking.html">Networking</a></li>
						<li><a href="functions-networking-messages.html">Networking Messages</a></li>
						<li><a href="functions-networking-sockets.html">Networking Sockets</a></li>
						<li><a href="functions-networking-types.html">Networking Types</a></li>
						<li><a href="functions-networking-utils.html">Networking Utils</a></li>
						<li><a href="functions-parental-settings.html">Parental Settings</a></li>
						<li><a href="functions-parties.html">Parties</a></li>
						<li><a href="functions-remote-play.html">Remote Play</a></li>
						<li><a href="functions-remote-storage.html">Remote Storage</a></li>
						<li><a href="functions-screenshots.html">Screenshots</a></li>
						<li><a href="functions-ugc.html">UGC</a></li>
						<li><a href="functions-user.html">User</a></li>
						<li><a href="functions-user-stats.html">User Stats</a></li>
						<li><a href="functions-utils.html">Utils</a></li>
						<li><a href="functions-video.html">Video</a></li>
					</ul>
				</li>
				<li>
					<span class="opener">Signals</span>
					<ul>
						<li><a href="signals-main.html">Main</a></li>
						<li><a href="signals-apps.html">Apps</a></li>
						<li><a href="signals-apps-list.html">Apps List</a></li>
						<li><a href="signals-friends.html">Friends</a></li>
						<li><a href="signals-game-search.html">Game Search</a></li>
						<li><a href="signals-game-server.html">Game Server</a></li>
						<li><a href="signals-game-server-stats.html">Game Server Stats</a></li>
						<li><a href="signals-html-surface.html">HTML Surface</a></li>
						<li><a href="signals-http.html">HTTP</a></li>
						<li><a href="signals-input.html">Input</a></li>
						<li><a href="signals-inventory.html">Inventory</a></li>
						<li><a href="signals-matchmaking.html">Matchmaking</a></li>
						<li><a href="signals-matchmaking-servers.html">Matchmaking Servers</a></li>
						<li><a href="signals-music-remote.html">Music Remote</a></li>
						<li><a href="signals-networking.html">Networking</a></li>
						<li><a href="signals-networking-sockets.html">Networking Sockets</a></li>
						<li><a href="signals-networking-utils.html">Networking Utils</a></li>
						<li><a href="signals-parental-settings.html">Parental Settings</a></li>
						<li><a href="signals-parties.html">Parties</a></li>
						<li><a href="signals-remote-play.html">Remote Play</a></li>
						<li><a href="signals-remote-storage.html">Remote Storage</a></li>
						<li><a href="signals-screenshots.html">Screenshots</a></li>
						<li><a href="signals-ugc.html">UGC</a></li>
						<li><a href="signals-user.html">User</a></li>
						<li><a href="signals-user-stats.html">User Stats</a></li>
						<li><a href="signals-utils.html">Utils</a></li>
						<li><a href="signals-video.html">Video</a></li>
					</ul>
				<li>
					<span class="opener">Godot 3.x Tutorials</span>
					<ul>
						<li><a href="tutorials-initializing.html">Initializing Steam</a></li>
						<li><a href="tutorials-stats-achievements.html">Stats and Achievements</a></li>
						<li><a href="tutorials-leaderboards.html">Leaderboards</a></li>
						<li><a href="tutorials-avatars.html">Avatars</a></li>
						<li><a href="tutorials-lobbies-p2p.html">Lobbies / P2P Networking</a></li>
						<li><a href="tutorials-authentication.html">Authentication</a></li>
						<li><a href="tutorials-mac-export.html">Mac Exporting</a></li>
						<li><a href="tutorials-achievement-icons.html">Achievement Icons</a></li>
						<li><a href="tutorials-auto-matchmaking.html">Auto-Matchmaking</a></li>
						<li><a href="tutorials-rich-presence.html">Rich Presence</a></li>
						<li><a href="tutorials-linux-caveats.html">Linux Caveats</a></li>
						<li><a href="tutorials-exporting-shipping.html">Exporting and Shipping</a></li>
						<li><a href="tutorials-common-issues.html">Common Issues</a></li>
						<li><a href="tutorials-remove-steam.html">Remove Steam</a></li>
					</ul>
				</li>
				<li><a href="games.html">Games Using GodotSteam</a></li>
				<li><a href="https://github.com/Gramps/GodotSteam/projects/1.html" target="_blank">To-Do</a></li>
				<li>
					<span class="opener">Change Log</span>
					<ul>
						<li><a href="changelog-godot4.html">Godot 4.x</a></li>
						<li><a href="changelog-godot3.html">Godot 3.x</a></li>
						<li><a href="changelog-godot2.html">Godot 2.x</a></li>
						<li><a href="changelog-gdnative.html">GDNative</a></li>
						<li><a href="changelog-server.html">Server</a></li>
					</ul>
				</li>
				<li><a href="contributors.html">Contributors</a></li>
			</ul>
		</nav>
		<section>
			<header class="major">
				<h2>Stuck? Need Help?</h2>
			</header>
			<p>Navigating Steamworks can be confusing sometimes. If you run across any problems, there's a few ways to get it ironed out.</p>
			<ul class="actions stacked">
				<li><a class="button primary" href="mailto:godotsteam@coaguco.com" target="_blank"><i class="fas fa-envelope-open-text"></i>&nbsp;&nbsp;Send A Support E-Mail</a></li>
				<li><a class="button primary" href="https://discord.gg/SJRSq6K" target="_blank"><i class="fab fa-discord"></i>&nbsp;&nbsp;Chat With Us On Discord</a></li>
			</ul>
		</section>
		<section>
			<header class="major">
				<h2>Donate</h2>
			</header>
			<p>If C++ is not your bag but you're feeling generous, you can support the project with your pocket change using either button below!</p>
			<ul class="actions stacked">
				<li><a class="button primary" href="https://github.com/sponsors/Gramps" target="_blank"><i class="fab fa-github"></i>&nbsp;&nbsp;with Github Sponsors</a></li>
				<li><a class="button primary" href="https://patreon.com/coaguco" target="_blank"><i class="fab fa-patreon"></i>&nbsp;&nbsp;with Patreon</a></li>
				<li><a class="button primary" href="https://www.paypal.me/sithlordkyle" target="_blank"><i class="fab fa-paypal"></i>&nbsp;&nbsp;with Paypal</a></li>
			</ul>
		</section>
		<footer>
			<ul class="actions stacked">
				<li>Godot Engine by <a href="https://godotengine.org">Juan Linietsky, Ariel Manzur and contributors</a></li>
				<li>Steamworks API by <a href="https://valvesoftware.com">Valve Corporation</a></li>
				<li>GodotSteam by <a href="https://coaguco.com">GP Garcia</a> and contributors</li>
				<li>Site Template by <a href="https://html5up.net">HTML5UP</a></li>
			</ul>
		</footer>
		<footer id="footer" class="copyright">
			2022 &copy; GP Garcia & CoaguCo Industries
		</footer>
	</div>
</div>		</div>
		<!-- Scripts -->
		<script src="js/jquery.min.js"></script>
		<script src="js/browser.min.js"></script>
		<script src="js/breakpoints.min.js"></script>
		<script src="js/util.js"></script>
		<script src="js/main.js"></script>
		<script src="js/godotsteam.js"></script>
	</body>
</html>
